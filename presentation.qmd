---
title: "LLM AI vs in game AI Performance"
subtitle: "INFO 523 - Fall 2025 - Final Project"
author: "Sebastian Robinson"
title-slide-attributes:
  data-background-image: images/watercolour_sys02_img34_teacup-ocean.jpg
  data-background-size: stretch
  data-background-opacity: "0.7"
  data-slide-number: none
format:
  revealjs:
    theme:  ['data/customtheming.scss']
  
editor: visual
jupyter: python3
execute:
  echo: false
---

```{python}
#| label: load-packages
#| include: false
import pandas as pd
import seaborn as sns
import os
import glob
import numpy as np
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler

BASE_DIR = os.getcwd()

metrics = [
    "Cities", "Population", "Territory",
    "Gold", "GoldPerTurn",
    "HappinessPercentage",
    "SciencePerTurn", "CulturePerTurn",
    "FaithPerTurn", "TourismPerTurn",
    "Technologies"
]

sns.set_theme(style="whitegrid")
sns.set_context("notebook", font_scale=1.1)
plt.rcParams['figure.dpi'] = 300
plt.rcParams['savefig.dpi'] = 300
plt.rcParams['figure.figsize'] = (6, 6 * 0.618)
```

```{python}
#| label: load-data
#| include: false
csv_dir = os.path.join(BASE_DIR, "data", "csv_exports")
files = glob.glob(os.path.join(csv_dir, "*.csv"))
dfs = {os.path.basename(f): pd.read_csv(f) for f in files}

df_players = dfs["PlayerSummaries.csv"].copy()
df_cities  = dfs["CityInformations.csv"].copy()

player_cols = [f"Player{i}" for i in range(22)]

def get_active_player(row):
    for i, col in enumerate(player_cols):
        if col in row and row[col] == 2:
            return i
    return np.nan

df_players["ActivePlayer"] = df_players.apply(get_active_player, axis=1)
df_players = df_players.dropna(subset=["ActivePlayer"])
df_players["ActivePlayer"] = df_players["ActivePlayer"].astype(int)
df_players["Turn"] = pd.to_numeric(df_players["Turn"], errors="coerce").astype(int)

df_cities["Turn"] = pd.to_numeric(df_cities["Turn"], errors="coerce")
df_cities = df_cities[df_cities["Owner"] != "City-States"].copy()

city_yields = (
    df_cities.groupby(["Turn", "Owner"])[[
        "Population","FoodPerTurn","ProductionPerTurn",
        "GoldPerTurn","SciencePerTurn","CulturePerTurn",
        "FaithPerTurn","TourismPerTurn","BuildingCount","WonderCount"
    ]]
    .mean()
    .reset_index()
)

city_yields = city_yields.rename(columns={"Owner":"OwnerID"})
city_yields = city_yields.dropna(subset=["OwnerID"])
city_yields["OwnerID"] = city_yields["OwnerID"].astype(int)
city_yields["Turn"] = pd.to_numeric(city_yields["Turn"], errors="coerce").astype(int)
```

## Research Question

DEFAULT TEXT

::: columns
How does a LLM perform against the base AI in Civilization 5?

-   Can the LLM's strategy change be detected
-   What Cause the change in strategy
:::

## Dataset Overview
::: {.r-fit-text}
::: columns
::: {.column width="50%"}
Data:

-   Dataset of one gameplay instance between 1 LLM and 3 in game AI's
-   This analysis focuses on resources from both players and cities over player turns

### PlayerSummaries Columns
```{python}
cols = df_players.columns.tolist()
cols[:5] + ["..."] + cols[-5:]
```
:::

::: {.column width="50%"}
### CityInformation Columns
```{python}
cols = df_cities.columns.tolist()
cols[:5] + ["..."] + cols[-5:]
```
:::
:::
:::

# Combined Heatmap

DEFAULT TEXT

```{python}
merged = pd.merge(
    df_players,
    city_yields,
    left_on=["Turn", "ActivePlayer"],
    right_on=["Turn", "OwnerID"],
    how="left"
)

valid_players = sorted(df_players["ActivePlayer"].unique())
df_filtered = merged[merged["ActivePlayer"].isin(valid_players)].copy()

df_filtered = df_filtered.drop(
    columns=[c for c in df_filtered.columns
             if c.startswith("Player")
             and int(c.replace("Player","")) not in valid_players],
    errors="ignore"
)

numeric_cols = df_filtered.select_dtypes("number").columns.tolist()

for col in ["Turn","ActivePlayer","OwnerID"]:
    if col in numeric_cols:
        numeric_cols.remove(col)

df_corr = df_filtered[numeric_cols].corr()

plt.figure(figsize=(16,13))
sns.heatmap(df_corr, cmap="coolwarm", annot=False)
plt.title("Combined Correlation Heatmap â€” All Players")
plt.show()
```

# Cities Controlled Per Turn

DEFAULT TEXT

```{python}
city_unique = df_cities.drop_duplicates(subset=["Turn", "Name", "Owner"])

cities_per_turn = (
    city_unique.groupby(["Turn", "Owner"])
               .size()
               .reset_index(name="CityCount")
)

plt.figure(figsize=(10,6))
sns.lineplot(data=cities_per_turn, x="Turn", y="CityCount", hue="Owner")
plt.title("Cities Controlled Per Turn")
plt.tight_layout()
plt.show()
```

# Player 0 Clustering Timeline

DEFAULT TEXT

```{python}
clean = df_players.dropna(subset=metrics + ["Turn", "ActivePlayer"]).copy()

scaler = StandardScaler()
X = scaler.fit_transform(clean[metrics])

kmeans = KMeans(n_clusters=4, n_init=10)
clean["Cluster"] = kmeans.fit_predict(X)

p0 = clean[clean["ActivePlayer"] == 0].sort_values("Turn")

plt.figure(figsize=(10,6))
sns.scatterplot(data=p0, x="Turn", y="Cluster", hue="Cluster", palette="tab10")
plt.title("Player 0 Cluster State Over Time")
plt.tight_layout()
plt.show()
```

# Player 0 Radar Chart

DEFAULT TEXT

```{python}
radar_metrics = [
    "GoldPerTurn", "SciencePerTurn", "CulturePerTurn",
    "FaithPerTurn", "TourismPerTurn", "Population",
    "Territory", "Cities"
]

p0_profile = (
    df_players[df_players["ActivePlayer"] == 0][radar_metrics]
    .mean()
)

categories = radar_metrics
N = len(categories)
values = p0_profile.values.flatten().tolist()
values += values[:1]

angles = np.linspace(0, 2 * np.pi, N, endpoint=False).tolist()
angles += angles[:1]

plt.figure(figsize=(6,6))
ax = plt.subplot(111, polar=True)
ax.plot(angles, values, linewidth=2)
ax.fill(angles, values, alpha=0.25)
ax.set_xticks(angles[:-1])
ax.set_xticklabels(categories)
plt.title("Player 0 Radar Profile")
plt.show()
```

